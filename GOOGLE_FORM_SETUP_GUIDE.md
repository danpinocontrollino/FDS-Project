# Google Form Setup Guide for Two-Stage Mental Health Profiling

## ðŸ“‹ Overview

This guide explains how to create a Google Form that collects the **minimum required data** for generating comprehensive two-stage mental health HTML reports.

---

## ðŸŽ¯ Required Data for Two-Stage Pipeline

The two-stage system needs **6 behavioral features** tracked daily for analysis:

### Stage 1 Input Features (Required):
1. **Sleep Hours** (decimal, e.g., 7.5)
2. **Work Hours** (decimal, e.g., 8.0)
3. **Exercise Minutes** (integer, e.g., 30)
4. **Steps Count** (integer, e.g., 8000)
5. **Screen Time Hours** (decimal, e.g., 6.5)
6. **Social Interactions** (integer, count of meaningful interactions)

### User Identification (Required):
- **Email** (to identify user across days)
- **Date** (to track temporal patterns)

---

## ðŸ“ Google Form Structure

### **Section 1: User Information**

**Question 1: Email Address**
- Type: **Short answer**
- Validation: Email format
- Required: âœ… Yes
- Description: "Your email address for report generation"

---

### **Section 2: Daily Behavioral Tracking**

Create **ONE form per day** (user fills it daily) OR **ONE form with 7 days** (user fills it once per week).

#### **Option A: Daily Form (Recommended for ongoing tracking)**

Each day, user fills a simple 6-question form:

---

**Question 2: Date**
- Type: **Date**
- Required: âœ… Yes
- Description: "What date are you reporting for?"

---

**Question 3: Sleep Hours**
- Type: **Short answer** (number validation)
- Validation: Number, 0-24
- Required: âœ… Yes
- Description: "How many hours did you sleep last night?"
- Example: "7.5"

---

**Question 4: Work Hours**
- Type: **Short answer** (number validation)
- Validation: Number, 0-24
- Required: âœ… Yes
- Description: "How many hours did you work today?"
- Example: "8"

---

**Question 5: Exercise Minutes**
- Type: **Short answer** (number validation)
- Validation: Number, 0-500
- Required: âœ… Yes
- Description: "How many minutes of exercise did you do today?"
- Example: "30"

---

**Question 6: Steps Count**
- Type: **Short answer** (number validation)
- Validation: Number, 0-50000
- Required: âœ… Yes
- Description: "How many steps did you take today? (check your phone/watch)"
- Example: "8000"

---

**Question 7: Screen Time Hours**
- Type: **Short answer** (number validation)
- Validation: Number, 0-24
- Required: âœ… Yes
- Description: "How many hours of screen time (excluding work)?"
- Example: "6.5"

---

**Question 8: Social Interactions**
- Type: **Short answer** (number validation)
- Validation: Number, 0-100
- Required: âœ… Yes
- Description: "How many meaningful social interactions did you have today? (conversations >5 min)"
- Example: "10"

---

#### **Option B: Weekly Form (7 days at once)**

Create 7 sections (Day 1, Day 2, etc.) with the same 6 questions repeated for each day.

**Section Title: "Day 1 - [Date]"**
- Day 1 - Sleep Hours
- Day 1 - Work Hours
- Day 1 - Exercise Minutes
- Day 1 - Steps Count
- Day 1 - Screen Time Hours
- Day 1 - Social Interactions

Repeat for Days 2-7.

---

## ðŸ“Š CSV Export Format

### Daily Form Export (Option A):
```csv
Timestamp,Email,Date,Sleep Hours,Work Hours,Exercise Minutes,Steps Count,Screen Time Hours,Social Interactions
2024-12-01 09:30:00,user@example.com,2024-12-01,7.5,8,30,8000,6.5,10
2024-12-02 09:30:00,user@example.com,2024-12-02,7,8.5,45,9500,6,12
...
```

### Weekly Form Export (Option B):
```csv
Timestamp,Email,Day 1 - Sleep Hours,Day 1 - Work Hours,Day 1 - Exercise Minutes,Day 1 - Steps Count,Day 1 - Screen Time Hours,Day 1 - Social Interactions,Day 2 - Sleep Hours,Day 2 - Work Hours,...
2024-12-07 15:00:00,user@example.com,7.5,8,30,8000,6.5,10,7,8.5,45,9500,6,12,...
```

---

## ðŸ”§ Using the CSV with HTML Generation

### Current System (StudentLife predictions):
The current system uses **pre-computed predictions** from `two_stage_predictions.json`. These were generated by:
1. Running Stage 1 model on StudentLife sensor data
2. Running Stage 2 model on Stage 1 outputs
3. Saving all predictions to JSON

### For New Google Form Data:

You need to create a **CSV-to-prediction pipeline** script. Here's what it should do:

```python
# Pseudocode for new script: generate_profile_from_form.py

1. Load CSV from Google Form
2. Parse daily behavioral data (6 features Ã— N days)
3. Load Stage 1 model (behavioral_forecasting)
4. Run Stage 1 predictions â†’ get predicted behaviors + uncertainties
5. Load Stage 2 model (mental_health_lstm)
6. Run Stage 2 predictions â†’ get mental health scores
7. Format as predictions list (same structure as two_stage_predictions.json)
8. Call generate_html_report() with predictions
```

---

## ðŸ“ Data Mapping

### Google Form Fields â†’ Model Features:

| Google Form Field | Model Input Feature | Stage | Type |
|------------------|---------------------|-------|------|
| Sleep Hours | `sleep_hours` | 1 | float |
| Work Hours | `work_hours` | 1 | float |
| Exercise Minutes | `exercise_minutes` | 1 | int |
| Steps Count | `steps_count` | 1 | int |
| Screen Time Hours | `screen_time_hours` | 1 | float |
| Social Interactions | `social_interactions` | 1 | int |

### Model Outputs â†’ HTML Report:

**Stage 1 Outputs (with uncertainties):**
- `sleep_hours` (predicted next day)
- `exercise_minutes` (predicted next day)
- `screen_time_hours` (predicted next day)
- `social_interactions` (predicted next day)
- `steps_count` (predicted next day)

**Stage 2 Outputs:**
- `stress_level` (0-10)
- `mood_score` (0-10)
- `energy_level` (0-10)
- `focus_score` (0-10)
- `perceived_stress_scale` (0-40, PSS-10)
- `anxiety_score` (0-21, GAD-7)
- `depression_score` (0-27, PHQ-9)
- `job_satisfaction` (0-10)

---

## âš™ï¸ Implementation Steps

### Step 1: Create Google Form
1. Go to [Google Forms](https://forms.google.com)
2. Create new form: "Daily Mental Health Tracking"
3. Add questions as specified above (Option A or B)
4. Enable email collection
5. Set up response destination (Google Sheets)

### Step 2: Export CSV
1. Open Google Sheets with responses
2. File â†’ Download â†’ CSV
3. Save as `user_tracking.csv`

### Step 3: Generate HTML Report

**Current limitation:** The existing `generate_two_stage_html.py` script expects **pre-computed predictions** from the two-stage pipeline, not raw CSV data.

**What you need:** A new script that:
1. Reads Google Form CSV
2. Runs Stage 1 model (behavioral forecasting)
3. Runs Stage 2 model (mental health inference)
4. Generates HTML using the same template

---

## ðŸ†• Required New Script

You need to create: **`scripts/generate_profile_from_google_form.py`**

This script should:

```python
def main():
    # 1. Load CSV from Google Form
    df = pd.read_csv("user_tracking.csv")
    
    # 2. Parse data per user
    users = df.groupby('Email')
    
    for email, user_df in users:
        # 3. Extract 6 features Ã— N days
        behavioral_data = extract_features(user_df)
        
        # 4. Load Stage 1 model
        stage1_model = load_stage1_model()
        
        # 5. Run Stage 1 predictions
        stage1_preds, stage1_unc = stage1_model.predict(behavioral_data)
        
        # 6. Load Stage 2 model
        stage2_model = load_stage2_model()
        
        # 7. Run Stage 2 predictions
        stage2_preds = stage2_model.predict(stage1_preds)
        
        # 8. Format predictions list
        predictions = format_predictions(
            dates=user_df['Date'],
            stage1_preds=stage1_preds,
            stage1_unc=stage1_unc,
            stage2_preds=stage2_preds
        )
        
        # 9. Generate HTML report
        generate_html_report(email, predictions, output_path)
```

---

## ðŸ“Œ Important Notes

1. **Minimum Data:** Need at least **7 consecutive days** of data for meaningful trend analysis

2. **Data Quality:** Missing values should be filled with user's mean or dataset mean

3. **Model Loading:** Stage 1 and Stage 2 models are in:
   - `models/saved/stage1_behavioral_forecasting.pt`
   - `models/saved/mental_health_lstm.pt`

4. **Feature Scaling:** Remember to apply the same normalization as training:
   - Stage 1: Uses scaler fitted on StudentLife data
   - Stage 2: Uses scaler fitted on synthetic data

5. **Uncertainty Quantification:** Stage 1 model outputs aleatoric uncertainty (log variance)

---

## ðŸŽ¯ Recommended Approach

### **Quick Start (Simple):**
Use **Option A (Daily Form)** with 8 questions. Users fill it once per day for 7+ days.

### **Advanced (Complete):**
Add optional questions for richer analysis:
- Sleep Quality (1-10)
- Work Pressure (1-3: low/medium/high)
- Diet Quality (1-10)
- Caffeine mg
- Alcohol Units
- Outdoor Minutes

These extra fields can be used for:
- Better trend visualization
- More personalized interventions
- Comparing predicted vs actual behaviors

---

## ðŸ“§ Example Google Form Link Structure

**Form Title:** "7-Day Mental Health & Behavioral Tracking"

**Description:**
> This form tracks your daily behaviors to generate a personalized mental health report. Fill this out once per day for 7 consecutive days. Your responses are confidential and will be used only to create your personalized report.

**Sections:**
1. Your Information (Email)
2. Daily Tracking (Date + 6 behavioral questions)
3. Optional Details (Sleep quality, diet, etc.)

---

## ðŸ”„ Workflow Summary

```
Google Form â†’ CSV Export â†’ Feature Extraction â†’ Stage 1 Model â†’ Stage 2 Model â†’ HTML Report
     â†“             â†“              â†“                    â†“               â†“              â†“
  User fills   Download    Parse 6 features    Predict behaviors  Predict mental  Generate
   daily       responses    Ã— N days          + uncertainties    health scores  comprehensive
                                                                                   HTML
```

---

## âœ… Checklist

- [ ] Create Google Form (8 questions minimum)
- [ ] Set up Google Sheets response destination
- [ ] Test form with sample data
- [ ] Export CSV
- [ ] Create `generate_profile_from_google_form.py` script
- [ ] Load Stage 1 model
- [ ] Load Stage 2 model
- [ ] Run predictions
- [ ] Generate HTML report
- [ ] Share report with user

---

## ðŸš€ Next Steps

**To make this work, you need to create the missing bridge script** that:
1. Takes Google Form CSV as input
2. Runs the two-stage prediction pipeline
3. Outputs HTML report

This script doesn't exist yet in your codebase. The current system works with pre-computed predictions from StudentLife data only.

Would you like me to create this script for you?
